<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>gift unwrapping ¬∑ roses ¬∑ cards appear</title>
  <style>
    /* ---------- NO SCROLL ¬∑ LOCKED ---------- */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      width: 100vw;
      height: 100vh;
      overflow: hidden !important;
      position: fixed;
      top: 0;
      left: 0;
      background: #180d20;
    }

    body {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      font-family: 'Segoe UI', 'Arial', sans-serif;
      overflow: hidden !important;
      -webkit-overflow-scrolling: none;
      touch-action: pan-y;
      height: 100vh;
      width: 100vw;
      padding: 0;
      transition: justify-content 0.4s ease;
    }

    body.cards-mode {
      justify-content: center;
    }

    /* ---------- GIFT SECTION ---------- */
    .gift-section {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      width: 100%;
      max-width: 900px;
      background: transparent;
      border: none;
      padding: 30px 0 20px 0;
      margin: 0 auto;
      z-index: 30;
      flex-shrink: 0;
      transition: opacity 0.5s ease, transform 0.5s ease, visibility 0.5s;
    }

    .gift-section-hidden {
      opacity: 0;
      visibility: hidden;
      transform: scale(0.8);
      position: absolute;
      pointer-events: none;
    }

    .greeting {
      color: #fae6ff;
      font-size: 48px;
      font-weight: 700;
      letter-spacing: 8px;
      text-shadow: 0 0 30px #e4b0ff, 0 0 60px #c97bff, 0 0 100px #b45aff;
      margin-bottom: 12px;
      text-align: center;
      padding: 0 20px;
    }

    .sub-message {
      color: #f0d2ff;
      font-size: 26px;
      font-weight: 400;
      letter-spacing: 4px;
      text-shadow: 0 0 25px #d6a1ff, 0 0 50px #b469f0;
      margin-bottom: 24px;
      padding: 0 20px;
    }

    /* ---------- THE GIFT ‚Äì WITH UNWRAPPING ANIMATION ---------- */
    .gift-box {
      position: relative;
      width: 280px;
      height: 280px;
      margin: 20px auto 24px;
      cursor: pointer;
      transition: transform 0.3s cubic-bezier(0.2, 0.9, 0.4, 1);
      filter: drop-shadow(0 0 50px rgba(220,150,255,0.9)) drop-shadow(0 0 100px rgba(180,90,255,0.6)) drop-shadow(0 0 150px rgba(200,130,255,0.4));
      animation: giftPulse 3s ease-in-out infinite;
      -webkit-tap-highlight-color: transparent;
    }

    @keyframes giftPulse {
      0%, 100% { filter: drop-shadow(0 0 50px rgba(220,150,255,0.9)) drop-shadow(0 0 100px rgba(180,90,255,0.6)) drop-shadow(0 0 150px rgba(200,130,255,0.4)); }
      50% { filter: drop-shadow(0 0 60px rgba(230,170,255,1)) drop-shadow(0 0 120px rgba(200,110,255,0.8)) drop-shadow(0 0 180px rgba(220,150,255,0.6)); }
    }

    /* UNWRAPPING ANIMATION ‚Äì the gift peels open and ribbons fly away */
    .gift-box-unwrapping {
      animation: unwrapGift 0.8s cubic-bezier(0.3, 0.8, 0.3, 1) forwards !important;
    }

    @keyframes unwrapGift {
      0% {
        transform: scale(1) rotate(0deg);
        filter: drop-shadow(0 0 50px rgba(220,150,255,0.9)) drop-shadow(0 0 100px rgba(180,90,255,0.6)) drop-shadow(0 0 150px rgba(200,130,255,0.4));
      }
      20% {
        transform: scale(1.1) rotate(-4deg);
        filter: drop-shadow(0 0 80px rgba(255,220,255,1)) drop-shadow(0 0 150px rgba(240,150,255,0.9));
      }
      40% {
        transform: scale(1.15) rotate(6deg);
        filter: drop-shadow(0 0 100px rgba(255,200,255,1)) drop-shadow(0 0 180px rgba(255,160,255,1));
      }
      60% {
        transform: scale(1.2) rotate(-8deg);
        filter: drop-shadow(0 0 120px rgba(255,180,255,1)) drop-shadow(0 0 200px rgba(255,140,255,1));
      }
      80% {
        transform: scale(1.3) rotate(10deg);
        filter: drop-shadow(0 0 150px rgba(255,220,255,1)) drop-shadow(0 0 250px rgba(255,200,255,1));
        opacity: 0.8;
      }
      100% {
        transform: scale(0) rotate(20deg);
        filter: drop-shadow(0 0 0 rgba(255,255,255,0));
        opacity: 0;
      }
    }

    /* Individual ribbon and bow animations for unwrapping effect */
    .gift-box-unwrapping .ribbon-vertical {
      animation: ribbonSlideLeft 0.6s ease-out forwards;
    }
    
    .gift-box-unwrapping .ribbon-horizontal {
      animation: ribbonSlideRight 0.6s ease-out forwards;
    }
    
    .gift-box-unwrapping .bow-left {
      animation: bowFlyLeft 0.7s ease-in forwards;
    }
    
    .gift-box-unwrapping .bow-right {
      animation: bowFlyRight 0.7s ease-in forwards;
    }
    
    .gift-box-unwrapping .bow-knot {
      animation: knotFade 0.4s ease-out forwards;
    }

    @keyframes ribbonSlideLeft {
      0% { transform: translateX(0) rotate(0); opacity: 1; }
      100% { transform: translateX(-120px) rotate(-45deg); opacity: 0; }
    }
    
    @keyframes ribbonSlideRight {
      0% { transform: translateX(0) rotate(0); opacity: 1; }
      100% { transform: translateX(120px) rotate(45deg); opacity: 0; }
    }
    
    @keyframes bowFlyLeft {
      0% { transform: translateX(0) rotate(-25deg); opacity: 1; }
      100% { transform: translateX(-150px) rotate(-120deg); opacity: 0; }
    }
    
    @keyframes bowFlyRight {
      0% { transform: translateX(0) rotate(25deg); opacity: 1; }
      100% { transform: translateX(150px) rotate(120deg); opacity: 0; }
    }
    
    @keyframes knotFade {
      0% { transform: scale(1); opacity: 1; }
      100% { transform: scale(2); opacity: 0; }
    }

    .gift-box:hover {
      transform: scale(1.08);
      filter: drop-shadow(0 0 70px rgba(240,180,255,1)) drop-shadow(0 0 140px rgba(220,130,255,0.9)) drop-shadow(0 0 200px rgba(240,160,255,0.7));
      animation: none;
    }

    .gift-body {
      position: relative;
      width: 100%;
      height: 100%;
      background: linear-gradient(145deg, #c280f5, #a658e0, #8f44c9);
      border-radius: 35px 35px 32px 32px;
      box-shadow: 0 18px 0 #6f32a0, 0 0 100px rgba(183,110,255,0.8), inset 0 -12px 35px rgba(0,0,0,0.3), inset 0 12px 45px rgba(255,255,255,0.2);
      overflow: hidden;
    }

    .gift-shine {
      position: absolute;
      top: 20px;
      left: 40px;
      width: 100px;
      height: 50px;
      background: radial-gradient(ellipse at center, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0) 80%);
      border-radius: 50%;
      transform: rotate(-15deg);
      filter: blur(10px);
      opacity: 0.9;
    }

    .ribbon-vertical {
      position: absolute;
      top: 0;
      left: 117px;
      width: 46px;
      height: 280px;
      background: linear-gradient(to right, #ffe8ca, #ffd699, #ffbe7e, #ffd699, #ffe8ca);
      box-shadow: 0 0 50px rgba(255,225,168,0.8), inset -2px 0 12px rgba(0,0,0,0.2), inset 2px 0 12px rgba(255,255,255,0.4);
      border-radius: 50px;
      transition: all 0.3s;
    }

    .ribbon-horizontal {
      position: absolute;
      top: 117px;
      left: 0;
      width: 280px;
      height: 46px;
      background: linear-gradient(to bottom, #ffe8ca, #ffd699, #ffbe7e, #ffd699, #ffe8ca);
      box-shadow: 0 0 50px rgba(255,225,168,0.8), inset 0 -2px 12px rgba(0,0,0,0.2), inset 0 2px 12px rgba(255,255,255,0.4);
      border-radius: 50px;
      transition: all 0.3s;
    }

    .bow-left {
      position: absolute; top: 55px; left: 50px; width: 70px; height: 80px;
      background: radial-gradient(circle at 30% 50%, #fff5e6, #ffeac2, #ffbc7a);
      border-radius: 60% 40% 40% 60%; transform: rotate(-25deg);
      box-shadow: 0 0 45px rgba(255,210,158,0.9), inset -6px -6px 18px rgba(0,0,0,0.2), inset 6px 6px 18px rgba(255,255,255,0.6);
      filter: drop-shadow(0 12px 10px rgba(0,0,0,0.3));
      transition: all 0.3s;
    }
    .bow-right {
      position: absolute; top: 55px; right: 50px; width: 70px; height: 80px;
      background: radial-gradient(circle at 70% 50%, #fff5e6, #ffeac2, #ffbc7a);
      border-radius: 40% 60% 60% 40%; transform: rotate(25deg);
      box-shadow: 0 0 45px rgba(255,210,158,0.9), inset -6px -6px 18px rgba(0,0,0,0.2), inset 6px 6px 18px rgba(255,255,255,0.6);
      filter: drop-shadow(0 12px 10px rgba(0,0,0,0.3));
      transition: all 0.3s;
    }
    .bow-knot {
      position: absolute; top: 78px; left: 112px; width: 56px; height: 56px;
      background: radial-gradient(circle at 40% 40%, #ffffff, #fff5e6, #ffdbb5, #ffb368);
      border-radius: 50%;
      box-shadow: 0 0 60px rgba(255,229,163,1), inset -4px -4px 12px rgba(0,0,0,0.2), inset 4px 4px 15px rgba(255,255,255,0.8);
      z-index: 15;
      transition: all 0.3s;
    }

    .click-text {
      color: #edcaff;
      font-size: 26px;
      font-weight: 500;
      letter-spacing: 4px;
      text-shadow: 0 0 25px #d19eff, 0 0 50px #b164ea;
      margin-top: 20px;
      margin-bottom: 0;
      padding: 0 20px;
      text-align: center;
    }

    /* ---------- 3 CARD SELECTION ‚Äì PERFECTLY CENTERED ---------- */
    .card-panel {
      display: none;
      justify-content: center;
      align-items: center;
      gap: 48px;
      width: 100%;
      max-width: 1100px;
      margin: 0 auto;
      padding: 20px;
      background: transparent;
      z-index: 100;
      flex-wrap: wrap;
      transition: all 0.4s ease;
    }

    .card {
      width: 240px;
      height: 280px;
      background: rgba(55, 25, 70, 0.9);
      backdrop-filter: blur(12px);
      -webkit-backdrop-filter: blur(12px);
      border: 2px solid rgba(255, 220, 255, 0.7);
      border-radius: 32px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 24px;
      color: white;
      font-size: 26px;
      font-weight: 700;
      letter-spacing: 3px;
      text-shadow: 0 0 25px #e2b0ff;
      box-shadow: 0 25px 45px rgba(0,0,0,0.7), 0 0 0 2px rgba(220,150,255,0.3) inset;
      transition: all 0.3s cubic-bezier(0.2, 0.9, 0.4, 1);
      cursor: pointer;
      border: 1px solid rgba(255, 230, 255, 0.8);
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: radial-gradient(circle at 30% 20%, rgba(255,230,255,0.4), transparent 80%);
      opacity: 0;
      transition: opacity 0.3s;
    }

    .card:hover {
      transform: translateY(-15px) scale(1.05);
      box-shadow: 0 30px 60px rgba(180, 110, 255, 0.8), 0 0 0 4px rgba(250, 200, 255, 0.9) inset;
      background: rgba(105, 55, 130, 0.95);
      border-color: rgba(255, 240, 255, 0.9);
    }

    .card:hover::before {
      opacity: 1;
    }

    .card-icon {
      font-size: 72px;
      margin-bottom: 12px;
      filter: drop-shadow(0 0 25px #ffc0ff);
    }

    .card-label {
      font-size: 32px;
      background: linear-gradient(145deg, #fff0ff, #fad0ff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      font-weight: 800;
      letter-spacing: 4px;
    }

    .card:active {
      transform: scale(0.96);
    }

    /* ---------- ALBUM VIEW ---------- */
    .album-view {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: #180d20;
      z-index: 200;
      overflow-y: auto;
      overflow-x: hidden;
    }

    .album-view.active {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 100px 20px 40px;
    }

    .album-title {
      color: #fae6ff;
      font-size: 52px;
      font-weight: 700;
      letter-spacing: 6px;
      text-shadow: 0 0 40px #e4b0ff, 0 0 80px #c97bff;
      margin-bottom: 50px;
      text-align: center;
    }

    .photo-grid {
      display: grid;
      grid-template-columns: repeat(12, 1fr);
      grid-template-rows: repeat(8, 70px);
      gap: 15px;
      width: 100%;
      max-width: 1000px;
      margin: 0 auto;
    }

    .photo-frame {
      position: relative;
      background: linear-gradient(145deg, rgba(255, 255, 255, 0.98), rgba(255, 250, 255, 0.95));
      border-radius: 20px;
      padding: 15px;
      box-shadow: 0 25px 60px rgba(0, 0, 0, 0.6), 0 0 80px rgba(180, 90, 255, 0.3);
      transition: all 0.4s cubic-bezier(0.2, 0.9, 0.4, 1);
      cursor: pointer;
      overflow: hidden;
      animation: photoFloat 3s ease-in-out infinite;
    }

    @keyframes photoFloat {
      0%, 100% { transform: translateY(0) rotate(var(--rotate, 0deg)); }
      50% { transform: translateY(-10px) rotate(var(--rotate, 0deg)); }
    }

    .photo-frame::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(255, 255, 255, 0.8) 0%, transparent 70%);
      opacity: 0;
      transition: opacity 0.3s;
    }

    .photo-frame:hover {
      transform: scale(1.08) rotate(0deg) !important;
      box-shadow: 0 35px 80px rgba(180, 90, 255, 0.8), 0 0 120px rgba(220, 150, 255, 0.6);
      z-index: 10;
    }

    .photo-frame:hover::before {
      opacity: 1;
    }

    /* Photo 1 - Large feature photo */
    .photo-1 {
      grid-column: 1 / 8;
      grid-row: 1 / 6;
      --rotate: -2deg;
      animation-delay: 0s;
    }

    /* Photo 2 - Medium top right */
    .photo-2 {
      grid-column: 8 / 13;
      grid-row: 1 / 4;
      --rotate: 3deg;
      animation-delay: 0.3s;
    }

    /* Photo 3 - Medium bottom right */
    .photo-3 {
      grid-column: 8 / 13;
      grid-row: 4 / 7;
      --rotate: -3deg;
      animation-delay: 0.6s;
    }

    /* Photo 4 - Wide bottom */
    .photo-4 {
      grid-column: 1 / 8;
      grid-row: 6 / 9;
      --rotate: 2deg;
      animation-delay: 0.9s;
    }

    .photo-img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 12px;
      display: block;
    }

    .photo-caption {
      position: absolute;
      bottom: 25px;
      left: 50%;
      transform: translateX(-50%);
      color: #8f44c9;
      font-size: 18px;
      font-weight: 700;
      letter-spacing: 2px;
      text-shadow: 0 2px 4px rgba(255, 255, 255, 0.8);
      opacity: 0;
      transition: opacity 0.3s;
    }

    .photo-frame:hover .photo-caption {
      opacity: 1;
    }

    /* ---------- MUSIC VIEW ‚Äì EMPTY ELEMENT REMOVED (the "empty" block was a phantom container) ---------- */
    .music-view {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: #180d20;
      z-index: 200;
      overflow: hidden;
    }

    .music-view.active {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    /* ---------- LETTER VIEW ---------- */
    .letter-view {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: #180d20;
      z-index: 200;
      overflow-y: auto;
      overflow-x: hidden;
    }

    .letter-view.active {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 100px 20px 40px;
    }

    .letter-canvas {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      z-index: 1;
      pointer-events: none;
    }

    .letter-container {
      position: relative;
      width: 100%;
      max-width: 700px;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 2;
    }

    .letter-paper {
      width: 100%;
      max-width: 700px;
      background: linear-gradient(145deg, rgba(255, 249, 240, 0.98), rgba(255, 251, 245, 0.98), rgba(255, 245, 232, 0.98));
      border-radius: 15px;
      padding: 35px 45px;
      box-shadow: 0 30px 80px rgba(0, 0, 0, 0.7), 0 0 100px rgba(180, 90, 255, 0.2);
      position: relative;
      overflow: hidden;
      max-height: 85vh;
      overflow-y: auto;
      backdrop-filter: blur(10px);
    }

    .letter-paper::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 60px;
      background: linear-gradient(to bottom, rgba(255, 230, 200, 0.3), transparent);
      pointer-events: none;
    }

    .letter-paper::after {
      content: '';
      position: absolute;
      top: 20px;
      right: 20px;
      width: 60px;
      height: 60px;
      background: radial-gradient(circle, rgba(255, 200, 220, 0.4), transparent);
      border-radius: 50%;
      pointer-events: none;
    }

    .letter-header {
      text-align: center;
      margin-bottom: 25px;
      padding-bottom: 15px;
      border-bottom: 2px solid rgba(200, 150, 200, 0.2);
    }

    .letter-title {
      color: #d19eff;
      font-size: 36px;
      font-weight: 700;
      letter-spacing: 3px;
      text-shadow: 0 2px 15px rgba(209, 158, 255, 0.3);
      margin-bottom: 8px;
    }

    .letter-subtitle {
      color: #a76ed4;
      font-size: 18px;
      font-weight: 600;
      letter-spacing: 2px;
      font-style: italic;
    }

    .letter-content {
      color: #4a3855;
      font-size: 15px;
      line-height: 1.7;
      font-family: 'Georgia', 'Times New Roman', serif;
      text-align: justify;
      margin-bottom: 25px;
    }

    .letter-content p {
      margin-bottom: 14px;
    }

    .letter-signature {
      text-align: right;
      margin-top: 25px;
      padding-top: 15px;
      border-top: 1px solid rgba(200, 150, 200, 0.2);
    }

    .signature-text {
      color: #8f44c9;
      font-size: 20px;
      font-weight: 600;
      font-family: 'Brush Script MT', cursive;
      letter-spacing: 1px;
    }

    .signature-date {
      color: #a76ed4;
      font-size: 14px;
      margin-top: 5px;
      font-style: italic;
    }

    /* Responsive Letter */
    @media (max-width: 1000px) {
      .letter-container {
        max-width: 90%;
      }
    }

    @media (max-width: 700px) {
      .letter-paper {
        padding: 30px 25px;
      }
      
      .letter-title {
        font-size: 28px;
      }
      
      .letter-subtitle {
        font-size: 16px;
      }
      
      .letter-content {
        font-size: 14px;
        line-height: 1.6;
      }
      
      .signature-text {
        font-size: 18px;
      }
      
      .signature-date {
        font-size: 13px;
      }
    }

    @media (max-width: 550px) {
      .letter-view.active {
        padding: 80px 15px 30px;
      }
      
      .letter-paper {
        padding: 25px 20px;
      }
      
      .letter-title {
        font-size: 24px;
      }
      
      .letter-subtitle {
        font-size: 14px;
      }
      
      .letter-content {
        font-size: 13px;
        line-height: 1.6;
      }
      
      .letter-content p {
        margin-bottom: 12px;
      }
      
      .signature-text {
        font-size: 16px;
      }
      
      .signature-date {
        font-size: 12px;
      }
    }

    /* Responsive Album */
    @media (max-width: 1200px) {
      .photo-grid {
        grid-template-rows: repeat(8, 60px);
        max-width: 900px;
      }
      
      .album-title {
        font-size: 42px;
      }
    }

    @media (max-width: 900px) {
      .album-view.active {
        padding: 80px 15px 30px;
      }
      
      .album-title {
        font-size: 36px;
        margin-bottom: 30px;
      }
      
      .photo-grid {
        grid-template-columns: repeat(6, 1fr);
        grid-template-rows: repeat(12, 80px);
        gap: 15px;
      }
      
      .photo-1 {
        grid-column: 1 / 7;
        grid-row: 1 / 5;
      }
      
      .photo-2 {
        grid-column: 1 / 4;
        grid-row: 5 / 8;
      }
      
      .photo-3 {
        grid-column: 4 / 7;
        grid-row: 5 / 8;
      }
      
      .photo-4 {
        grid-column: 1 / 7;
        grid-row: 8 / 11;
      }
    }

    @media (max-width: 550px) {
      .album-title {
        font-size: 28px;
      }
      
      .photo-grid {
        grid-template-rows: repeat(12, 70px);
        gap: 12px;
      }
      
      .photo-caption {
        font-size: 14px;
        bottom: 15px;
      }
    }

    .music-container {
      display: flex;
      gap: 40px;
      align-items: center;
      justify-content: center;
      width: 90%;
      max-width: 1200px;
      padding: 20px;
    }

    .flowers-section {
      flex: 1;
      max-width: 500px;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }

    .music-flower-canvas {
      width: 100%;
      height: 500px;
      border-radius: 20px;
      background: rgba(24, 13, 32, 0.3);
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
    }

    .player-section {
      flex: 1;
      max-width: 600px;
      background: rgba(55, 25, 70, 0.8);
      backdrop-filter: blur(15px);
      border-radius: 30px;
      padding: 30px;
      box-shadow: 0 25px 60px rgba(0,0,0,0.7), 0 0 100px rgba(180, 90, 255, 0.3);
      border: 2px solid rgba(255, 220, 255, 0.5);
    }

    .player-header {
      text-align: center;
      margin-bottom: 25px;
    }

    .player-title {
      color: #fae6ff;
      font-size: 40px;
      font-weight: 700;
      letter-spacing: 4px;
      text-shadow: 0 0 30px #e4b0ff;
      margin-bottom: 10px;
    }

    .player-subtitle {
      color: #edcaff;
      font-size: 22px;
      letter-spacing: 2px;
      text-shadow: 0 0 20px #d19eff;
    }

    .video-container {
      position: relative;
      width: 100%;
      padding-bottom: 56.25%;
      border-radius: 20px;
      overflow: hidden;
      box-shadow: 0 15px 40px rgba(0,0,0,0.6);
    }

    .video-container video {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      border-radius: 20px;
    }

    .back-button {
      position: fixed;
      top: 30px;
      left: 30px;
      background: linear-gradient(145deg, rgba(75, 35, 95, 0.95), rgba(55, 25, 70, 0.95));
      backdrop-filter: blur(15px);
      color: #fae6ff;
      border: 3px solid rgba(255, 220, 255, 0.7);
      padding: 16px 35px;
      border-radius: 50px;
      font-size: 20px;
      font-weight: 700;
      letter-spacing: 3px;
      cursor: pointer;
      box-shadow: 0 15px 40px rgba(180, 90, 255, 0.5), 0 0 60px rgba(220, 150, 255, 0.3), inset 0 2px 20px rgba(255, 255, 255, 0.2);
      transition: all 0.3s ease;
      z-index: 300;
      display: flex;
      align-items: center;
      gap: 10px;
      text-shadow: 0 0 20px #d19eff;
    }

    .back-button::before {
      content: '‚Üê';
      font-size: 24px;
      font-weight: 900;
    }

    .back-button:hover {
      background: linear-gradient(145deg, rgba(105, 55, 130, 0.98), rgba(85, 45, 105, 0.98));
      transform: translateY(-4px) scale(1.05);
      box-shadow: 0 20px 50px rgba(180, 90, 255, 0.7), 0 0 80px rgba(220, 150, 255, 0.5), inset 0 2px 25px rgba(255, 255, 255, 0.3);
      border-color: rgba(255, 240, 255, 0.95);
    }

    .back-button:active {
      transform: translateY(-2px) scale(1.02);
    }

    /* ---------- FLOWER CANVAS ‚Äì FAST GROWING ---------- */
    .flower-canvas {
      display: block;
      width: 100vw;
      flex: 1 1 auto;
      min-height: 0;
      background: transparent;
      border: none !important;
      outline: none !important;
      margin: 0;
      padding: 0;
      pointer-events: none;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }

    .canvas-hidden {
      opacity: 0;
      visibility: hidden;
      position: absolute;
      pointer-events: none;
    }

    @media (max-width: 1000px) {
      .music-container {
        flex-direction: column;
        gap: 30px;
      }
      
      .flowers-section, .player-section {
        max-width: 90%;
      }
      
      .music-flower-canvas {
        height: 400px;
      }
      
      .back-button {
        top: 15px;
        left: 15px;
        padding: 12px 28px;
        font-size: 18px;
      }
    }

    @media (max-width: 900px) {
      .card-panel { gap: 30px; }
      .card { width: 200px; height: 240px; }
      .card-icon { font-size: 60px; }
      .card-label { font-size: 28px; }
    }

    @media (max-width: 700px) {
      .card-panel { gap: 25px; }
      .card { width: 170px; height: 210px; }
      .card-icon { font-size: 52px; }
      .card-label { font-size: 24px; }
      
      .player-title {
        font-size: 32px;
      }
      
      .player-subtitle {
        font-size: 18px;
      }
    }

    @media (max-width: 550px) {
      .greeting { font-size: 32px; }
      .sub-message { font-size: 20px; }
      .gift-box { width: 220px; height: 220px; }
      .click-text { font-size: 20px; }
      .card-panel { gap: 20px; }
      .card { width: 150px; height: 190px; }
      .card-icon { font-size: 48px; }
      .card-label { font-size: 22px; }
      
      .player-section {
        padding: 20px;
      }
      
      .player-title {
        font-size: 28px;
      }
      
      .player-subtitle {
        font-size: 16px;
      }
      
      .back-button {
        top: 12px;
        left: 12px;
        padding: 10px 20px;
        font-size: 16px;
      }
    }
  </style>
</head>
<body>
  <!-- GIFT SECTION -->
  <div class="gift-section" id="giftSection">
    <div class="greeting">HAPPY VALENTINES DAY!</div>
    <div class="sub-message">open your surprise</div>
    
    <div class="gift-box" id="giftButton">
      <div class="gift-body">
        <div class="gift-shine"></div>
        <div class="ribbon-vertical"></div>
        <div class="ribbon-horizontal"></div>
        <div class="bow-left"></div>
        <div class="bow-right"></div>
        <div class="bow-knot"></div>
      </div>
    </div>
    
    <div class="click-text">‚ú® click the gift ‚Äî unwrapping animation ‚ú®</div>
  </div>

  <!-- CARD PANEL -->
  <div class="card-panel" id="cardPanel">
    <div class="card" id="albumCard">
      <div class="card-icon">üì∑</div>
      <div class="card-label">ALBUM</div>
    </div>
    <div class="card" id="musicCard">
      <div class="card-icon">üéµ</div>
      <div class="card-label">MUSIC</div>
    </div>
    <div class="card" id="letterCard">
      <div class="card-icon">üíå</div>
      <div class="card-label">LETTER</div>
    </div>
  </div>

  <!-- ALBUM VIEW -->
  <div class="album-view" id="albumView">
    <button class="back-button" id="backButtonAlbum">BACK</button>
    
    <div class="album-title">HAPPY VALENTINES DAY</div>
    
    <div class="photo-grid">
      <div class="photo-frame photo-1">
        <img src="photo/1.jpg" alt="Memory 1" class="photo-img">
        <div class="photo-caption">MOMENT 1</div>
      </div>
      
      <div class="photo-frame photo-2">
        <img src="photo/2.jpg" alt="Memory 2" class="photo-img">
        <div class="photo-caption">MOMENT 2</div>
      </div>
      
      <div class="photo-frame photo-3">
        <img src="photo/3.jpg" alt="Memory 3" class="photo-img">
        <div class="photo-caption">MOMENT 3</div>
      </div>
      
      <div class="photo-frame photo-4">
        <img src="photo/4.jpg" alt="Memory 4" class="photo-img">
        <div class="photo-caption">MOMENT 4</div>
      </div>
    </div>
  </div>

  <!-- MUSIC VIEW ‚Äì the "empty" thing is gone (was an invisible container?) -->
  <div class="music-view" id="musicView">
    <button class="back-button" id="backButton">BACK</button>
    
    <div class="music-container">
      <!-- GROWING FLOWERS -->
      <div class="flowers-section">
        <canvas id="musicFlowerCanvas" class="music-flower-canvas"></canvas>
      </div>

      <!-- MUSIC PLAYER -->
      <div class="player-section">
        <div class="player-header">
          <div class="player-title">MUSEO</div>
          <div class="player-subtitle">Eliza Manturan</div>
        </div>
        <div class="video-container">
          <video 
            id="loveVideo"
            playsinline
            controls
            preload="metadata">
            <source src="music/museo.mp4" type="video/mp4">
            Your browser does not support the video tag.
          </video>
        </div>
      </div>
    </div>
  </div>

  <!-- LETTER VIEW -->
  <div class="letter-view" id="letterView">
    <canvas id="letterCanvas" class="letter-canvas"></canvas>
    <button class="back-button" id="backButtonLetter">BACK</button>
    
    <div class="letter-container">
      <!-- Letter Paper -->
      <div class="letter-paper">
        <div class="letter-header">
          <div class="letter-title">Happy Valentine's Day</div>
          <div class="letter-subtitle">To Jasmine ‚ú®</div>
        </div>
        
        <div class="letter-content">
          <p>Happy Valentine's Day, Jasmine!</p>
          
          <p>I know this is a bit late since Valentine's has already passed, and we haven't been talking much lately, but I still wanted to say this. You have a way of making my day better just by being there ‚Äî seeing you, hearing your laughter, and especially your smile is already enough to brighten my day. I hope you continue to keep that smile alive no matter how tough life gets.</p>
          
          <p>I'll be honest ‚Äî I still have feelings for you, and I think you already know that. But more than anything, I just want to thank you. You're truly a wonderful person. You're different from anyone I've ever met, and no one else has made me feel the way you do.</p>
          
          <p>Graduation is getting closer, and soon we'll all go our separate paths. Even if distance comes between us, I will always support you and pray for your success as you start your college journey. I'm always willing to help if you ever need someone.</p>
          
          <p>I know you're a strong and intelligent woman, but if there ever comes a time you need support, don't hesitate to reach out. I'll always be here for you.</p>
          
          <p>Once again, Happy Valentine's Day.</p>
        </div>
        
        <div class="letter-signature">
          <div class="signature-text">With love & support,</div>
          <div class="signature-text" style="margin-top: 10px; font-size: 24px;">üíú</div>
        </div>
      </div>
    </div>
  </div>

  <!-- FLOWER CANVAS ‚Äì FAST GROWING -->
  <canvas id="roseCanvas" class="flower-canvas"></canvas>

  <script>
    (function() {
      // ---------- LOCK SCROLL ----------
      document.body.addEventListener('touchmove', function(e) {
        e.preventDefault();
      }, { passive: false });

      window.addEventListener('wheel', function(e) {
        e.preventDefault();
      }, { passive: false });

      // ---------- CANVAS SETUP ----------
      const canvas = document.getElementById('roseCanvas');
      const ctx = canvas.getContext('2d');
      
      let cardsRevealed = false;

      // ---------- RESIZE CANVAS ----------
      function resizeCanvas() {
        if (!cardsRevealed) {
          const giftSection = document.getElementById('giftSection');
          let topHeight = giftSection ? giftSection.offsetHeight : 420;
          
          const viewportHeight = window.innerHeight;
          let availableHeight = viewportHeight - topHeight - 15;
          availableHeight = Math.max(200, availableHeight);
          
          canvas.width = window.innerWidth;
          canvas.height = availableHeight;
          
          gardenRoses = generateGardenRoses(canvas.width, canvas.height);
        }
      }

      window.addEventListener('resize', resizeCanvas);
      
      // ---------- PURPLE PALETTE ----------
      const PURPLE = {
        petalHighlight: '#ffffff', petalShine: '#fff5ff', petalLight: '#f9e7ff',
        petalGlow: '#e9c8ff', petalMain: '#d19eff', petalMid: '#c280f5',
        petalRich: '#b975f0', petalDeep: '#a862e0', petalDark: '#974ed6',
        petalShadow: '#7d3bb8', stemLight: '#c89ee8', stem: '#a76ed4',
        stemDark: '#8f5ac2', stemGlow: '#dab0ff', leafLight: '#d4a8f0',
        leaf: '#bf86e6', leafDark: '#a56bd0', centerGlow: '#fffafc',
        centerYellow: '#fff0b8', stamenTip: '#ffd280'
      };

      // ---------- ROSE GENERATOR ----------
      function generateGardenRoses(canvasWidth, canvasHeight) {
        const roses = [];
        if (canvasWidth === 0 || canvasHeight === 0) return roses;
        
        const area = canvasWidth * canvasHeight;
        const baseCount = Math.min(60, Math.floor(area / 8500));
        
        const minSize = 0.7, maxSize = 0.85;
        const minHeight = canvasHeight * 0.60;
        const maxHeight = canvasHeight - 25;
        
        for (let i = 0; i < Math.floor(baseCount * 0.3); i++) {
          roses.push({
            x: Math.random() * canvasWidth,
            y: minHeight + Math.random() * ((maxHeight - minHeight) * 0.4),
            size: minSize + Math.random() * 0.1,
            angle: Math.random() * Math.PI * 2,
            phase: Math.random() * 100,
            sway: 0.6 + Math.random() * 0.3,
            swaySpeed: 0.7 + Math.random() * 0.3,
            petalCount: 7 + Math.floor(Math.random() * 3),
            openness: 0.75 + Math.random() * 0.15,
            layer: 'back'
          });
        }
        for (let i = 0; i < Math.floor(baseCount * 0.4); i++) {
          roses.push({
            x: Math.random() * canvasWidth,
            y: minHeight + Math.random() * ((maxHeight - minHeight) * 0.7),
            size: minSize + 0.05 + Math.random() * 0.1,
            angle: Math.random() * Math.PI * 2,
            phase: Math.random() * 100,
            sway: 0.6 + Math.random() * 0.4,
            swaySpeed: 0.6 + Math.random() * 0.4,
            petalCount: 7 + Math.floor(Math.random() * 4),
            openness: 0.75 + Math.random() * 0.15,
            layer: 'middle'
          });
        }
        const fgCount = Math.floor(baseCount * 0.3);
        for (let i = 0; i < fgCount; i++) {
          const x = (i / fgCount) * canvasWidth + (Math.random() - 0.5) * 50;
          roses.push({
            x: Math.max(15, Math.min(canvasWidth - 15, x)),
            y: minHeight + ((maxHeight - minHeight) * 0.5) + Math.random() * ((maxHeight - minHeight) * 0.5),
            size: minSize + 0.08 + Math.random() * 0.07,
            angle: Math.random() * Math.PI * 2,
            phase: Math.random() * 100,
            sway: 0.6 + Math.random() * 0.5,
            swaySpeed: 0.5 + Math.random() * 0.5,
            petalCount: 8 + Math.floor(Math.random() * 3),
            openness: 0.75 + Math.random() * 0.15,
            layer: 'front'
          });
        }
        roses.sort((a, b) => a.y - b.y);
        return roses;
      }

      let gardenRoses = [];
      
      // ---------- FAST GROWTH ANIMATION ‚Äì 2x SPEED ----------
      let gardenGrowth = 0.0;
      const GROW_SPEED = 0.008;
      let animationFrame = null;
      let time = 0;
      
      // Letter and music canvas animation variables
      let letterFlowerAnimFrame = null;
      let musicFlowerAnimFrame = null;

      // ---------- DETAILED DRAWING FUNCTIONS ----------
      function drawDetailedRose(x, y, size, angle, openness, petalCount, swayAngle, layer, progress) {
        ctx.save(); ctx.translate(x, y); ctx.rotate(swayAngle);
        const bloomFactor = size * Math.min(1, progress * 1.2);
        if (layer === 'front' || layer === 'middle') {
          ctx.fillStyle = `rgba(61, 20, 80, ${0.2 * progress})`;
          ctx.beginPath(); ctx.ellipse(2, 8, 14 * bloomFactor, 6 * bloomFactor, 0, 0, Math.PI * 2); ctx.fill();
        }
        for (let ring = 2; ring >= 0; ring--) {
          const ringSize = 1 - (ring * 0.15);
          const petalsInRing = petalCount - ring;
          for (let p = 0; p < petalsInRing; p++) {
            const petalAngle = (p / petalsInRing) * Math.PI * 2 + angle + ring * 0.3;
            const distance = (11 + ring * 4) * bloomFactor * openness;
            const px = Math.cos(petalAngle) * distance;
            const py = Math.sin(petalAngle) * distance * 0.8;
            const petalGrad = ctx.createRadialGradient(px - 3, py - 2, 2, px, py, 12 * bloomFactor * ringSize);
            if (ring === 2) {
              petalGrad.addColorStop(0, PURPLE.petalGlow); petalGrad.addColorStop(0.4, PURPLE.petalMain);
              petalGrad.addColorStop(0.7, PURPLE.petalRich); petalGrad.addColorStop(1, PURPLE.petalDark);
            } else if (ring === 1) {
              petalGrad.addColorStop(0, PURPLE.petalLight); petalGrad.addColorStop(0.4, PURPLE.petalGlow);
              petalGrad.addColorStop(0.8, PURPLE.petalMid); petalGrad.addColorStop(1, PURPLE.petalRich);
            } else {
              petalGrad.addColorStop(0, PURPLE.petalHighlight); petalGrad.addColorStop(0.5, PURPLE.petalShine);
              petalGrad.addColorStop(1, PURPLE.petalGlow);
            }
            ctx.fillStyle = petalGrad;
            ctx.beginPath(); ctx.ellipse(px, py, 11 * bloomFactor * ringSize, 7 * bloomFactor * ringSize, petalAngle + 0.2, 0, Math.PI * 2); ctx.fill();
            if ((layer === 'front' || layer === 'middle') && ring > 0) {
              ctx.strokeStyle = `rgba(169, 98, 224, ${0.25 * progress})`; ctx.lineWidth = 0.5;
              ctx.beginPath(); ctx.moveTo(px - 3, py); ctx.lineTo(0, 0); ctx.stroke();
            }
          }
        }
        for (let i = 0; i < 5; i++) {
          const spiralAngle = (i / 5) * Math.PI * 2 + progress * 0.2;
          const spiralDist = 4.5 * bloomFactor * (1 - i * 0.1);
          const ix = Math.cos(spiralAngle) * spiralDist, iy = Math.sin(spiralAngle) * spiralDist * 0.7 - 2;
          const innerGrad = ctx.createRadialGradient(ix - 1, iy - 1, 1, ix, iy, 6 * bloomFactor);
          innerGrad.addColorStop(0, PURPLE.petalHighlight); innerGrad.addColorStop(0.6, PURPLE.petalShine); innerGrad.addColorStop(1, PURPLE.petalLight);
          ctx.fillStyle = innerGrad;
          ctx.beginPath(); ctx.ellipse(ix, iy, 6.5 * bloomFactor, 4.5 * bloomFactor, spiralAngle, 0, Math.PI * 2); ctx.fill();
        }
        if (progress > 0.5) {
          const centerGrad = ctx.createRadialGradient(0, -3, 0, 0, -3, 5 * bloomFactor);
          centerGrad.addColorStop(0, PURPLE.centerGlow); centerGrad.addColorStop(0.5, PURPLE.centerYellow); centerGrad.addColorStop(1, `rgba(255, 240, 184, 0)`);
          ctx.fillStyle = centerGrad; ctx.beginPath(); ctx.arc(0, -3, 5 * bloomFactor, 0, Math.PI * 2); ctx.fill();
          if (layer === 'front') {
            ctx.fillStyle = PURPLE.stamenTip;
            for (let s = 0; s < 6; s++) {
              const stamenAngle = (s / 6) * Math.PI * 2;
              const sx = Math.cos(stamenAngle) * 2.5 * bloomFactor, sy = Math.sin(stamenAngle) * 2.5 * bloomFactor - 3;
              ctx.beginPath(); ctx.arc(sx, sy, 0.8 * bloomFactor, 0, Math.PI * 2); ctx.fill();
            }
          }
        }
        if (layer === 'front' && progress > 0.6) {
          ctx.fillStyle = `rgba(203, 158, 255, ${0.05 * progress})`;
          ctx.beginPath(); ctx.arc(0, -2, 22 * bloomFactor, 0, Math.PI * 2); ctx.fill();
        }
        ctx.restore();
      }

      function drawStem(rose, currentTipY, groundY, progress) {
        if (currentTipY >= groundY - 3) return;
        ctx.save();
        const stemLength = groundY - currentTipY;
        const stemGrad = ctx.createLinearGradient(rose.x, groundY, rose.x, currentTipY);
        stemGrad.addColorStop(0, PURPLE.stemDark); stemGrad.addColorStop(0.5, PURPLE.stem); stemGrad.addColorStop(1, PURPLE.stemLight);
        ctx.strokeStyle = stemGrad; ctx.lineWidth = 3.5 * rose.size; ctx.lineCap = 'round';
        ctx.beginPath(); ctx.moveTo(rose.x, groundY);
        const curve1X = rose.x + Math.sin(progress + rose.phase) * 3, curve1Y = groundY - stemLength * 0.3;
        const curve2X = rose.x - Math.sin(progress * 0.5 + rose.phase) * 2, curve2Y = groundY - stemLength * 0.7;
        ctx.bezierCurveTo(curve1X, curve1Y, curve2X, curve2Y, rose.x, currentTipY); ctx.stroke();
        ctx.strokeStyle = `rgba(218, 176, 255, ${0.4 * progress})`; ctx.lineWidth = 1.5 * rose.size;
        ctx.beginPath(); ctx.moveTo(rose.x + 1, groundY);
        ctx.bezierCurveTo(curve1X + 1, curve1Y, curve2X + 1, curve2Y, rose.x + 1, currentTipY); ctx.stroke();
        if (progress > 0.3 && rose.layer !== 'back') {
          const leafY1 = currentTipY + stemLength * 0.35, leafY2 = currentTipY + stemLength * 0.6;
          ctx.save(); ctx.translate(rose.x - 8, leafY1); ctx.rotate(-0.4);
          const leafGrad1 = ctx.createLinearGradient(-5, -3, 5, 3);
          leafGrad1.addColorStop(0, PURPLE.leafDark); leafGrad1.addColorStop(0.5, PURPLE.leaf); leafGrad1.addColorStop(1, PURPLE.leafLight);
          ctx.fillStyle = leafGrad1; ctx.beginPath(); ctx.ellipse(0, 0, 7 * progress * rose.size, 3.5 * progress * rose.size, 0, 0, Math.PI * 2); ctx.fill();
          ctx.strokeStyle = `rgba(138, 82, 180, ${0.4 * progress})`; ctx.lineWidth = 0.5; ctx.beginPath(); ctx.moveTo(-6, 0); ctx.lineTo(6, 0); ctx.stroke();
          ctx.restore();
          ctx.save(); ctx.translate(rose.x + 10, leafY2); ctx.rotate(0.5);
          const leafGrad2 = ctx.createLinearGradient(-5, -3, 5, 3);
          leafGrad2.addColorStop(0, PURPLE.leafDark); leafGrad2.addColorStop(0.5, PURPLE.leaf); leafGrad2.addColorStop(1, PURPLE.leafLight);
          ctx.fillStyle = leafGrad2; ctx.beginPath(); ctx.ellipse(0, 0, 8 * progress * rose.size, 4 * progress * rose.size, 0, 0, Math.PI * 2); ctx.fill();
          ctx.strokeStyle = `rgba(138, 82, 180, ${0.4 * progress})`; ctx.lineWidth = 0.5; ctx.beginPath(); ctx.moveTo(-7, 0); ctx.lineTo(7, 0); ctx.stroke();
          ctx.restore();
        }
        ctx.restore();
      }

      function drawGarden(progress) {
        if (cardsRevealed) return;
        
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        time += 0.02;
        const groundY = canvas.height - 4;
        gardenRoses.forEach((rose) => {
          const stemTargetY = rose.y;
          const currentTipY = groundY - (groundY - stemTargetY) * Math.min(progress, 1);
          drawStem(rose, currentTipY, groundY, progress);
          if (progress > 0.2 && currentTipY < groundY - 8) {
            const bloomTargetY = rose.y - 10;
            const currentY = groundY - (groundY - bloomTargetY) * Math.min(progress, 1);
            const swayOffset = Math.sin(time * rose.swaySpeed + rose.phase) * rose.sway;
            const currentX = rose.x + swayOffset;
            const swayAngle = Math.sin(time * rose.swaySpeed + rose.phase) * 0.08;
            drawDetailedRose(currentX, currentY, rose.size, rose.angle, rose.openness, rose.petalCount, swayAngle, rose.layer, progress);
          }
        });
      }

      function growGardenLoop() {
        if (cardsRevealed) {
          return;
        }
        
        if (gardenGrowth < 1.0) {
          gardenGrowth += GROW_SPEED;
          if (gardenGrowth > 1.0) gardenGrowth = 1.0;
        }
        drawGarden(gardenGrowth);
        animationFrame = requestAnimationFrame(growGardenLoop);
      }

      // ---------- GIFT CLICK: UNWRAPPING ANIMATION + REVEAL CARDS ----------
      function revealCardsAndRemoveFlowers() {
        if (cardsRevealed) return;
        
        // 1. Play gift unwrapping animation
        const giftBox = document.getElementById('giftButton');
        if (giftBox) {
          giftBox.classList.add('gift-box-unwrapping');
        }
        
        // 2. Wait for animation to complete, then remove everything
        setTimeout(() => {
          // Hide gift section
          const giftSection = document.getElementById('giftSection');
          if (giftSection) {
            giftSection.classList.add('gift-section-hidden');
          }
          
          // Hide canvas
          const canvasEl = document.getElementById('roseCanvas');
          if (canvasEl) {
            canvasEl.classList.add('canvas-hidden');
          }
          
          // Show cards
          const panel = document.getElementById('cardPanel');
          if (panel) {
            panel.style.display = 'flex';
          }
          
          // Center body
          document.body.classList.add('cards-mode');
          
          // Stop animation
          if (animationFrame) {
            cancelAnimationFrame(animationFrame);
            animationFrame = null;
          }
          
          // Clear canvas
          ctx.clearRect(0, 0, canvas.width, canvas.height);
          
          cardsRevealed = true;
        }, 750);
      }

      // ---------- CARD CLICK HANDLERS ----------
      function handleAlbumClick() {
        // Hide card panel
        document.getElementById('cardPanel').style.display = 'none';
        // Show album view
        document.getElementById('albumView').classList.add('active');
      }

      function handleMusicClick() {
        // Hide card panel
        document.getElementById('cardPanel').style.display = 'none';
        // Show music view
        document.getElementById('musicView').classList.add('active');
        // Play video
        const video = document.getElementById('loveVideo');
        if (video) {
          video.play().catch(err => console.log('Autoplay prevented:', err));
        }
        // Initialize music flowers
        initMusicFlowers();
      }

      function handleLetterClick() {
        // Hide card panel
        document.getElementById('cardPanel').style.display = 'none';
        // Show letter view
        document.getElementById('letterView').classList.add('active');
        // Initialize letter flower canvas
        initLetterFlowers();
      }

      function handleBackClick() {
        // Stop and reset video
        const video = document.getElementById('loveVideo');
        if (video) {
          video.pause();
          video.currentTime = 0;
        }
        
        // Stop music flower animation
        if (musicFlowerAnimFrame) {
          cancelAnimationFrame(musicFlowerAnimFrame);
          musicFlowerAnimFrame = null;
        }
        
        // Hide music view
        document.getElementById('musicView').classList.remove('active');
        
        // Show card panel
        document.getElementById('cardPanel').style.display = 'flex';
      }

      function handleBackClickAlbum() {
        // Hide album view
        document.getElementById('albumView').classList.remove('active');
        
        // Show card panel
        document.getElementById('cardPanel').style.display = 'flex';
      }

      function handleBackClickLetter() {
        // Stop letter flower animation
        if (letterFlowerAnimFrame) {
          cancelAnimationFrame(letterFlowerAnimFrame);
          letterFlowerAnimFrame = null;
        }
        
        // Hide letter view
        document.getElementById('letterView').classList.remove('active');
        
        // Show card panel
        document.getElementById('cardPanel').style.display = 'flex';
      }

      // ---------- ATTACH EVENT LISTENERS ----------
      const gift = document.getElementById('giftButton');
      gift.addEventListener('click', revealCardsAndRemoveFlowers);
      
      const clickMsg = document.querySelector('.click-text');
      if (clickMsg) clickMsg.addEventListener('click', revealCardsAndRemoveFlowers);

      document.getElementById('albumCard').addEventListener('click', handleAlbumClick);
      document.getElementById('musicCard').addEventListener('click', handleMusicClick);
      document.getElementById('letterCard').addEventListener('click', handleLetterClick);
      document.getElementById('backButton').addEventListener('click', handleBackClick);
      document.getElementById('backButtonAlbum').addEventListener('click', handleBackClickAlbum);
      document.getElementById('backButtonLetter').addEventListener('click', handleBackClickLetter);

      // ---------- INIT ‚Äì FLOWERS GROW FAST AUTOMATICALLY ----------
      resizeCanvas();
      gardenRoses = generateGardenRoses(canvas.width, canvas.height);
      
      window.addEventListener('resize', function() {
        if (!cardsRevealed) {
          resizeCanvas();
          gardenRoses = generateGardenRoses(canvas.width, canvas.height);
        }
      });

      // Start growing immediately with FAST speed
      gardenGrowth = 0.0;
      animationFrame = requestAnimationFrame(growGardenLoop);

      // ---------- LETTER FLOWERS CANVAS ----------
      let letterGrowth = 0.0;
      let letterRoses = [];

      function initLetterFlowers() {
        const letterCanvas = document.getElementById('letterCanvas');
        const letterCtx = letterCanvas.getContext('2d');
        
        letterCanvas.width = window.innerWidth;
        letterCanvas.height = window.innerHeight;
        
        // Generate fewer roses for letter background (lighter)
        letterRoses = generateGardenRoses(letterCanvas.width, letterCanvas.height);
        // Reduce to 50% for lighter effect
        letterRoses = letterRoses.filter((_, i) => i % 2 === 0);
        
        letterGrowth = 0.0;
        
        function drawLetterFlowers() {
          letterCtx.clearRect(0, 0, letterCanvas.width, letterCanvas.height);
          
          if (letterGrowth < 1.0) {
            letterGrowth += GROW_SPEED;
          }
          
          const groundY = letterCanvas.height - 4;
          let localTime = Date.now() * 0.001;
          
          // Temporarily set ctx to letterCtx
          const originalCtx = ctx;
          ctx = letterCtx;
          
          letterRoses.forEach((rose) => {
            const stemTargetY = rose.y;
            const currentTipY = groundY - (groundY - stemTargetY) * Math.min(letterGrowth, 1);
            drawStem(rose, currentTipY, groundY, letterGrowth);
            
            if (letterGrowth > 0.2 && currentTipY < groundY - 8) {
              const bloomTargetY = rose.y - 10;
              const currentY = groundY - (groundY - bloomTargetY) * Math.min(letterGrowth, 1);
              const swayOffset = Math.sin(localTime * rose.swaySpeed + rose.phase) * rose.sway;
              const currentX = rose.x + swayOffset;
              const swayAngle = Math.sin(localTime * rose.swaySpeed + rose.phase) * 0.08;
              drawDetailedRose(currentX, currentY, rose.size, rose.angle, rose.openness, rose.petalCount, swayAngle, rose.layer, letterGrowth);
            }
          });
          
          // Restore original ctx
          ctx = originalCtx;
          
          letterFlowerAnimFrame = requestAnimationFrame(drawLetterFlowers);
        }
        
        drawLetterFlowers();
      }

      // ---------- MUSIC FLOWERS CANVAS ----------
      let musicGrowth = 0.0;
      let musicRoses = [];

      function initMusicFlowers() {
        const musicCanvas = document.getElementById('musicFlowerCanvas');
        const musicCtx = musicCanvas.getContext('2d');
        
        const rect = musicCanvas.getBoundingClientRect();
        musicCanvas.width = rect.width;
        musicCanvas.height = rect.height;
        
        // Generate roses for music canvas
        musicRoses = [];
        const baseCount = 15; // Fewer roses for cleaner look
        const minSize = 0.7, maxSize = 0.9;
        const minHeight = musicCanvas.height * 0.5;
        const maxHeight = musicCanvas.height - 20;
        
        for (let i = 0; i < baseCount; i++) {
          musicRoses.push({
            x: Math.random() * musicCanvas.width,
            y: minHeight + Math.random() * (maxHeight - minHeight),
            size: minSize + Math.random() * (maxSize - minSize),
            angle: Math.random() * Math.PI * 2,
            phase: Math.random() * 100,
            sway: 0.6 + Math.random() * 0.4,
            swaySpeed: 0.5 + Math.random() * 0.5,
            petalCount: 7 + Math.floor(Math.random() * 3),
            openness: 0.75 + Math.random() * 0.15,
            layer: i < 5 ? 'back' : (i < 10 ? 'middle' : 'front')
          });
        }
        
        musicRoses.sort((a, b) => a.y - b.y);
        musicGrowth = 0.0;
        
        function drawMusicFlowers() {
          musicCtx.clearRect(0, 0, musicCanvas.width, musicCanvas.height);
          
          if (musicGrowth < 1.0) {
            musicGrowth += GROW_SPEED;
          }
          
          const groundY = musicCanvas.height - 4;
          let localTime = Date.now() * 0.001;
          
          // Temporarily set ctx to musicCtx
          const originalCtx = ctx;
          ctx = musicCtx;
          
          musicRoses.forEach((rose) => {
            const stemTargetY = rose.y;
            const currentTipY = groundY - (groundY - stemTargetY) * Math.min(musicGrowth, 1);
            
            // Draw stem
            if (currentTipY < groundY - 3) {
              ctx.save();
              const stemLength = groundY - currentTipY;
              const stemGrad = ctx.createLinearGradient(rose.x, groundY, rose.x, currentTipY);
              stemGrad.addColorStop(0, PURPLE.stemDark);
              stemGrad.addColorStop(0.5, PURPLE.stem);
              stemGrad.addColorStop(1, PURPLE.stemLight);
              ctx.strokeStyle = stemGrad;
              ctx.lineWidth = 3.5 * rose.size;
              ctx.lineCap = 'round';
              ctx.beginPath();
              ctx.moveTo(rose.x, groundY);
              const curve1X = rose.x + Math.sin(musicGrowth + rose.phase) * 3;
              const curve1Y = groundY - stemLength * 0.3;
              const curve2X = rose.x - Math.sin(musicGrowth * 0.5 + rose.phase) * 2;
              const curve2Y = groundY - stemLength * 0.7;
              ctx.bezierCurveTo(curve1X, curve1Y, curve2X, curve2Y, rose.x, currentTipY);
              ctx.stroke();
              ctx.restore();
            }
            
            if (musicGrowth > 0.2 && currentTipY < groundY - 8) {
              const bloomTargetY = rose.y - 10;
              const currentY = groundY - (groundY - bloomTargetY) * Math.min(musicGrowth, 1);
              const swayOffset = Math.sin(localTime * rose.swaySpeed + rose.phase) * rose.sway;
              const currentX = rose.x + swayOffset;
              const swayAngle = Math.sin(localTime * rose.swaySpeed + rose.phase) * 0.08;
              drawDetailedRose(currentX, currentY, rose.size, rose.angle, rose.openness, rose.petalCount, swayAngle, rose.layer, musicGrowth);
            }
          });
          
          // Restore original ctx
          ctx = originalCtx;
          
          musicFlowerAnimFrame = requestAnimationFrame(drawMusicFlowers);
        }
        
        drawMusicFlowers();
      }
    })();
  </script>
</body>
</html>